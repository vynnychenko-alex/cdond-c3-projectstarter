---
  - name: Copy files
    become: true
    copy:
      src: /root/project/artifact.tar.gz
      dest: /home/ubuntu/artifact.tar.gz
  - name: Unarchive
    become: true
    shell : |
        cd /home/ubuntu/
        tar xvzf artifact.tar.gz -C .
  - name: "run server"
    become: true
    shell : |
        cd /home/ubuntu/
          sudo su
          echo ENVIRONMENT=production >> ".env"
          echo NODE_ENV=production >> ".env"
          echo TYPEORM_CONNECTION=postgres >> ".env"
          echo TYPEORM_MIGRATIONS_DIR=./src/migrations >> ".env"
          echo TYPEORM_ENTITIES=./src/modules/domain/**/*.entity.ts >> ".env"
          echo TYPEORM_MIGRATIONS=./src/migrations/*.ts >> ".env"
          echo TYPEORM_HOST=$TYPEORM_HOST >> ".env"
          echo TYPEORM_PORT=$TYPEORM_PORT >> ".env"
          echo TYPEORM_USERNAME=$TYPEORM_USERNAME >> ".env"
          echo TYPEORM_PASSWORD=$TYPEORM_PASSWORD >> ".env"
          echo TYPEORM_DATABASE=$TYPEORM_DATABASE >> ".env"